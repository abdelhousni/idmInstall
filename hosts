all:
  children:
    ipaserver:
      hosts: 
        idm.blog.example.com: 
          ipaserver_domain: "{{ idm_short }}.{{ root_domain }}"
          ipaserver_realm: "{{ ipaserver_domain | upper}}"
          ipaserver_setup_dns: yes
          ipaserver_reverse_zones: "1.168.192.in-addr.arpa"
          ipaserver_allow_zone_overlap: yes
          ipaserver_no_forwarders: yes
          ipaserver_firewalld_zone: public
    ipareplicas:
      hosts: 
        rep.blog.example.com: 
          ipareplica_no_forwarders: yes
          ipareplica_setup_ca: yes
          ipareplica_setup_dns: yes
          ipareplica_firewalld_zone: public
          network_connections:
            - name: "{{ ansible_default_ipv4.alias }}"
              state: up
              type: ethernet
              persistent_state: present
              ip:
                dhcp4: no
                dns: "{{ nameserver }}"
                address: "{{ ansible_default_ipv4.address }}/24"
                gateway4: "{{ ansible_default_ipv4.gateway }}"
    ipaclients:
      hosts: 
        rh8.blog.example.com: 
          ipaclient_mkhomedir: yes
          network_connections:
            - name: "{{ ansible_default_ipv4.alias }}"
              state: up
              type: ethernet
              persistent_state: present
              ip:
                dhcp4: no
                dns: "{{ nameserver }}"
                address: "{{ ansible_default_ipv4.address }}/24"
                gateway4: "{{ ansible_default_ipv4.gateway }}"
  vars:
    idm_short: "blog"
    root_domain: "example.com"
    nameserver: "192.168.160.82"
    ipaadmin_password: "<IdM Admin password>"
    ipadm_password: "<IdM Directory Manager password>"
    